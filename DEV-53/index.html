<!DOCTYPE html>
<html lang="pt-BR">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Estrelas de Avaliação</title>
	<link rel="stylesheet" type="text/css" href="estilo.css">
</head>
<body>
	<main>
		<ul id="lista-estrelas">
			<li class="ion-star" data-avaliacao="5"></li>
			<li class="ion-star" data-avaliacao="4"></li>
			<li class="ion-star" data-avaliacao="3"></li>
			<li class="ion-star" data-avaliacao="2"></li>
			<li class="ion-star" data-avaliacao="1"></li>
		</ul>
	</main>

<script>
const listaEstrelas = document.getElementById('lista-estrelas');

listaEstrelas.addEventListener('click', (event) => {
  // event.currentTarget é o <ul>, o elemento ao qual o event listener foi anexado
  // event.target é o <li> clicado
  const estrelaClicada = event.target;
  const avaliacao = estrelaClicada.dataset.avaliacao;

  if (avaliacao) {
    console.log(`Você clicou na estrela com a avaliação: ${avaliacao}`);

	enviarAvaliacaoParaOPHP(avaliacao);
 }
});

function enviarAvaliacaoParaOPHP(avaliacao) {
    fetch('gravar_avaliacao.php', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
      },
      body: `avaliacao=${avaliacao}` // Envia a pontuação no corpo da requisição
    })
    .then(response => response.text())
    .then(data => {
      console.log('Resposta do servidor:', data);
      alert('Avaliação salva com sucesso!');
    })
    .catch(error => {
      console.error('Erro:', error);
      alert('Ocorreu um erro ao salvar a avaliação.');
    });
  }

</script>

</body>
</html>